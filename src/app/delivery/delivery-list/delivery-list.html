<div class="delivery-list-container">
  <div class="header-section">
    <h2>Delivery Tracking</h2>
    <button mat-icon-button (click)="refresh()" class="refresh-button" title="Refresh">
      <mat-icon>refresh</mat-icon>
    </button>
  </div>
  
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading deliveries...</p>
  </div>

  <!-- Error Message -->
  <mat-card *ngIf="errorMessage && showRetry && !isLoading" class="error-card">
    <mat-card-content>
      <div class="error-content">
        <mat-icon color="warn">error</mat-icon>
        <span>{{ errorMessage }}</span>
      </div>
      <button mat-button color="primary" (click)="onRetry()">
        <mat-icon>refresh</mat-icon>
        Retry
      </button>
    </mat-card-content>
  </mat-card>

  <div *ngIf="!isLoading && !showRetry" class="table-container">
    <mat-table [dataSource]="deliveries" class="delivery-table">
      
      <!-- Delivery Number Column -->
      <ng-container matColumnDef="deliveryNumber">
        <mat-header-cell *matHeaderCellDef>Delivery Number</mat-header-cell>
        <mat-cell *matCellDef="let delivery">{{ delivery.deliveryNumber }}</mat-cell>
      </ng-container>

      <!-- Product Code Column -->
      <ng-container matColumnDef="productCode">
        <mat-header-cell *matHeaderCellDef>Product Code</mat-header-cell>
        <mat-cell *matCellDef="let delivery">{{ delivery.productCode }}</mat-cell>
      </ng-container>

      <!-- Product Description Column -->
      <ng-container matColumnDef="productDescription">
        <mat-header-cell *matHeaderCellDef>Product Description</mat-header-cell>
        <mat-cell *matCellDef="let delivery">{{ delivery.productDescription }}</mat-cell>
      </ng-container>

      <!-- Delivery Quantity Column -->
      <ng-container matColumnDef="deliveryQuantity">
        <mat-header-cell *matHeaderCellDef>Quantity</mat-header-cell>
        <mat-cell *matCellDef="let delivery">{{ delivery.deliveryQuantity }} {{ delivery.unit }}</mat-cell>
      </ng-container>

      <!-- Created Date Column -->
      <ng-container matColumnDef="createdDate">
        <mat-header-cell *matHeaderCellDef>Created Date</mat-header-cell>
        <mat-cell *matCellDef="let delivery">{{ delivery.createdDate | date:'MM/dd/yyyy' }}</mat-cell>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
        <mat-cell *matCellDef="let delivery">
          <span [class]="getStatusClass(delivery.status)">{{ delivery.status }}</span>
        </mat-cell>
      </ng-container>

      <!-- Actions Column -->
      <ng-container matColumnDef="actions">
        <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
        <mat-cell *matCellDef="let delivery">
          <button mat-button color="primary" (click)="onViewDetails(delivery.deliveryNumber)">
            View Details
          </button>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </mat-table>

    <div *ngIf="deliveries.length === 0 && !showRetry" class="no-data">
      <p>No deliveries found.</p>
    </div>
  </div>
</div>
